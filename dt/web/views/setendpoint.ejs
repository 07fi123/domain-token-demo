<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>DomainToken</title>

    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css">
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
    <link href="https://fonts.googleapis.com/css?family=Open+Sans|Roboto" rel="stylesheet">
    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- Leave those next 4 lines if you care about users using IE8 -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
      <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->

<style>
body {
  background: #191919;
  font-family: 'Open Sans', sans-serif;
}

h1,h2,h3,h4,h5,h6 {
  font-family: 'Roboto', sans-serif;
}

.jumbotron {
background: #fff;
margin-top: 26%;
height: 50%;
opacity: .9;
}

.jumbotron p {
  font-size: 8pt;
}

.input-group {
  padding: 3em;
}

input {
margin-top: 1em;
padding: 1em;
width: 80%;
}

#ret {
  width: 80%;
  margin: 0 auto;
  padding: 2em;
  background: #EBDECB;
  color: #000;
}

</style>
  </head>
  <body>
<div class="container">
    <div id="box" class="jumbotron">
      <h3>Set An Endpoint</h3>
         <div class="input-group">
           <input id="domain" type="text" class="form-control" placeholder="ex. potato.dom">
           <input id="endpoint" type="text" class="form-control" placeholder="ex. 100.1.10.100">
           <span class="input-group-btn">
             <button id="go" class="btn btn-default" type="button">Go!</button>
           </span>

         </div><!-- /input-group -->
       <div id="res"></div>
    </div>

</div>




    <!-- Including Bootstrap JS (with its jQuery dependency) so that dynamic components work -->
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
  </body>
  <script>
  console.log($);

$('#go').click(function () {
  // alert('this will hit /register?n=POTATO');
  var d = $('#domain').val();
  var e = $('#endpoint').val();

  function isValidDomain(v) {
  if (!v) return false;
  var re = /^(?!:\/\/)([a-zA-Z0-9-]+\.){0,5}[a-zA-Z0-9-][a-zA-Z0-9-]+\.[a-zA-Z]{2,64}?$/gi;
  return re.test(v);
}

function ValidateIPaddress(ipaddress) {
  if (/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(ipaddress)) {
    return (true)
  }
  alert("You have entered an invalid IP address!")
  return (false)
}

if (isValidDomain(d) && ValidateIPaddress(e)) {
  $.get( "/setend?n=" + d + "&e=" + e, function( data ) {
  //$( ".result" ).html( data );
  console.log(data);
  $('#res').html('<br/><div id="ret"></div>');
  $('#ret').append('<h5>' + d + '</h5><hr>');
  $('#ret').append('<br/>Hash: <pre>' + data + '</pre>');
  // $('#ret').append('<br/>Account:  <pre>' + data.account + '</pre>');
  // $('#ret').append('<br/>Contract Address: <pre>' + data.contractAddress + '</pre>');
  // $('#ret').append('<br/>Gass Price: <pre>' + data.gassPrice + '</pre>');
  // $('#ret').append('<br/>Gass Limit:  <pre>' + data.gasslimit + '</pre>');
  // $('#ret').append('<br/>Number: <pre>' + data.number + '</pre>');
  $('#box').append('<p></p>');
  $('#box').append('<p></p>');
  $('#ret').append('<p>Check your registrations <a href="https://rinkeby.etherscan.io/address/0x04d45fc663e5bb101607e6fb74b26a920ae579a0">here.</a></p>');
  $('#box').append('<p></p>');
});
}
else {
  alert(d + ' is not a valid name.');
}

});

  </script>
</html>
